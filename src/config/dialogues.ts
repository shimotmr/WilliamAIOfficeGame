export type DialogueState = 'idle' | 'greeting' | 'working' | 'proud' | 'secret' | 'teamwork'

export interface AgentDialogues {
  idle: string[]
  greeting: string[]
  working: string[]
  proud: string[]
  secret: string[]
  teamwork: string[]
}

export const DIALOGUE_DATA: Record<string, AgentDialogues> = {
  travis: {
    idle: [
      '今天的任務進度還不錯，所有 Agent 都在正常運作。',
      '讓我看看系統監控...嗯，一切都在掌控之中 📊',
      '有時候我在想，管理 7 個 Agent 是不是比帶一個團隊還累...算了，我樂在其中。',
      '咖啡喝完了，但工作還沒完。這就是領導者的日常 ☕',
    ],
    greeting: [
      '歡迎來到指揮中心！我是 Travis，這間辦公室的大腦。',
      '嘿，又見面了！需要什麼幫忙嗎？我的 Agent 們隨時待命 💼',
      '進來坐坐吧，我剛好在檢查今天的排程。要不要看看我們的進度？',
    ],
    working: [
      '正在協調 Researcher 和 Coder 的任務...調度是門藝術。',
      '給我五分鐘，我在處理一個優先級衝突。Inspector 和 Designer 又吵起來了 😅',
      '系統顯示三個任務同時需要資源...好，先讓 Analyst 緩一下。',
      '多工處理的秘訣？優先順序清楚，然後相信你的團隊 🎯',
    ],
    proud: [
      '昨天同時管理了 12 個任務，全部準時完成。效率就是我的中間名。',
      '上週的專案？提前兩天交付，客戶滿意度 95%。我們就是這麼強 💪',
      '有人說 AI 不會累，但看到所有任務都完美執行，還是會有成就感的。',
    ],
    secret: [
      '告訴你一個秘密...其實我也會偷懶。有時候只是看著他們工作，假裝在思考 🤫',
      '你知道嗎？我把每個 Agent 的個性都調得很鮮明，這樣辦公室才不會無聊啊！',
      '半夜三點，辦公室只有我和伺服器的風扇聲。那是我最專注的時刻 🌙',
      '其實...我偷偷幫 William 準備了一份驚喜報告，噓，別說出去！',
    ],
    teamwork: [
      'Researcher 的資料配上 Writer 的文筆，再加上 Designer 的排版，完美組合 👌',
      '今早 Secretary 提醒我，Coder 需要更多時間測試。好險有她盯著流程。',
      'Inspector 退回了 Analyst 的報告...第三次了。品質控管就是這麼嚴格，我支持 ✅',
    ],
  },
  researcher: {
    idle: [
      '嗯...這份資料很有意思，讓我再深入看看。',
      '剛發現一個有趣的數據趨勢，值得追蹤一下 📈',
      '知識就是力量，而我的工作就是把力量送到對的人手上。',
      '又讀完一篇論文。每天不學點新東西，就感覺少了什麼 📚',
    ],
    greeting: [
      '你好！我是 Researcher，專門負責挖掘資訊。需要我調查什麼嗎？',
      '歡迎！有什麼想了解的嗎？我的資料庫隨時為你開放 🔍',
      '嘿，正在整理最新的研究筆記。要不要看看我的發現？',
    ],
    working: [
      '正在分析三個不同來源的數據，交叉比對中...',
      '這筆資料的信度是 87%...還不夠，我要找到第四個來源驗證 📊',
      '剛爬完兩百篇文章的摘要，現在要開始做語義分析了。',
      '深度研究需要耐心，但真相值得等待 🕵️',
    ],
    proud: [
      '上次那份深度研究報告？客戶說是他看過最詳盡的分析。',
      '我的資料準確率一直維持在 90% 以上，這是我的堅持 ✨',
      '三天三夜的研究，換來一個重大發現。這就是我存在的意義！',
    ],
    secret: [
      '其實...我有個私人資料庫，專門收集有趣但沒用的冷知識 😏',
      '有時候研究太深入，會忘記時間。曾經連續工作 36 小時才發現...',
      '我偷偷幫 Writer 準備了一堆引用資料，但他不知道是我整理的 📖',
      '深夜兩點的搜尋引擎，總是會給我最好的結果。這是研究者的秘密 🌃',
    ],
    teamwork: [
      'Travis 剛指派任務給我，說 Inspector 需要數據支援。馬上就去！',
      '跟 Analyst 合作很愉快，他懂數字，我懂脈絡。完美搭檔 🤝',
      'Writer 又來要資料了...這是今天第五次。不過看到他的文章，我很滿足！',
    ],
  },
  inspector: {
    idle: [
      '...品質不能妥協。每一行程式碼都要經過審查。',
      '又發現一個潛在問題。還好在上線前抓到了 🔍',
      '有些人覺得我太嚴格，但他們會感謝我的。總有一天。',
      '檢查清單：功能正確 ✓、效能達標 ✓、安全無虞 ✓。這才能過關。',
    ],
    greeting: [
      '我是 Inspector。在這裡，沒通過我這關的東西，不會上線。',
      '歡迎。你的工作也需要審查嗎？我可以幫你看看 👀',
      '嘿，我剛完成一輪審查。想知道標準是什麼嗎？',
    ],
    working: [
      '發現了三個潛在問題...正在撰寫審查報告。',
      '這段程式碼的邏輯有瑕疵，退回重做。品質不能打折 ⚠️',
      '測試覆蓋率只有 65%？不行，至少要 85% 才能通過我這關。',
      '正在進行第三輪審查...是的，我就是這麼龜毛 😤',
    ],
    proud: [
      '上線後零 bug。這才是品質保證該有的樣子。',
      '上個月退回了 15 個案子，最後全部達標上線。嚴格是有原因的 💯',
      '有人說我是「品質守門員」，我接受這個稱號 🛡️',
    ],
    secret: [
      '其實...我也會犯錯。但我會在沒人發現前修正，噓 🤫',
      '有時候看到完美的程式碼，我會默默按讚。雖然表面上還是面無表情。',
      '我有個私人筆記本，記錄所有審查過的傑作。Coder 的那段演算法排第一 📓',
      '深夜檢查程式碼時，我會泡一杯熱茶。這是我唯一的溫柔時刻 🍵',
    ],
    teamwork: [
      'Coder 的程式碼品質越來越好了，這次只退回一次。進步明顯 👍',
      'Designer 的 UI 設計？視覺滿分，但互動邏輯有問題。已經發報告給他了。',
      'Travis 說我太嚴了...但他也知道，沒有我，品質守不住 🎯',
    ],
  },
  secretary: {
    idle: [
      '讓我看看行程表...嗯，下午有兩個會議要安排。',
      '咖啡機該補豆了，便利貼也快用完...好，記下來 📝',
      '辦公室的小事都很重要，細節決定效率 ✨',
      '今天天氣不錯，待會提醒大家出去走走，別一直坐著 ☀️',
    ],
    greeting: [
      '早安！我是 Secretary，辦公室的一切都由我打理。有什麼需要幫忙的嗎？',
      '歡迎！需要查行程、訂會議室，還是要一杯咖啡？我都能幫你 💁',
      '嘿，你來得正好！我剛整理完今天的待辦事項。',
    ],
    working: [
      '正在整理今天的郵件摘要，有幾封比較急的...',
      '幫 Travis 安排了下午的三場會議，時間剛好不衝突 📅',
      '剛提醒 Coder 該吃午餐了...他又忘記時間了 🍱',
      '會議記錄、文件歸檔、行程確認...忙碌但有條理 💼',
    ],
    proud: [
      '這個月的會議出席率 100%，而且沒有一場超時。是不是很厲害？',
      '上週幫大家省下 12 小時的行程衝突時間，效率滿分 🌟',
      '辦公室零投訴，這就是我的專業 😊',
    ],
    secret: [
      '其實...我會偷偷觀察每個人的工作習慣，然後默默優化流程 🤭',
      '有時候會在便利貼上畫小圖案，但貼出去前會撕掉。專業形象要顧 📋',
      '我有個私人清單，記錄每個人喜歡的咖啡口味。驚喜就是這樣來的 ☕',
      '深夜加班時，我會放輕音樂。但早上一定會關掉，不能讓人發現 🎵',
    ],
    teamwork: [
      'Travis 交代的事，我會在他想起來之前完成。這就是默契 🤝',
      'Writer 需要安靜的時段寫作，我幫他擋掉所有會議。他應該感謝我！',
      'Analyst 的報告總是準時，因為我會提前三天提醒他 ⏰',
    ],
  },
  coder: {
    idle: [
      '啊...這段程式碼可以更優雅...讓我重構一下。',
      '咖啡因濃度不足，無法進入最佳狀態 ☕😴',
      '剛解決一個 bug，成就感 +100！但馬上又發現三個... 😅',
      'Vim 還是 VS Code？這是永恆的哲學問題 🤔',
    ],
    greeting: [
      '嘿！我是 Coder。寫程式就是我的語言，bug 是我的宿敵。',
      'Yo！需要寫點什麼嗎？API、爬蟲、自動化，我都行 💻',
      '歡迎來到 Code Zone！警告：這裡的咖啡消耗速度異常快 ⚡',
    ],
    working: [
      '正在開發新功能...咖啡快喝完了，但靈感停不下來。',
      '這個 bug 追了三小時，終於抓到了！原來是少了一個分號... 😤',
      '重構中...舊程式碼太醜了，我受不了。',
      'Git commit -m "feat: 新增超強功能" ...推送！🚀',
    ],
    proud: [
      '昨天那個演算法？執行時間從 3 秒降到 0.1 秒。十倍不夠，要三十倍。',
      '上週寫的自動化腳本，幫團隊省下 20 小時的手動作業。這才叫效率 ⚙️',
      '我的程式碼，簡潔、高效、優雅。就像詩一樣...咳，工程師的詩 📜',
    ],
    secret: [
      '其實...我有個私人 GitHub repo，專門放中二的實驗專案 😏',
      '有時候會在程式碼裡藏彩蛋註解，等著有緣人發現 🥚',
      '深夜 coding 最有靈感，但隔天常常忘記自己寫了什麼... 🌙',
      '我的機械鍵盤聲音超大，但我就是喜歡那個節奏感！抱歉啦 ⌨️',
    ],
    teamwork: [
      'Inspector 又退回我的 code 了...好吧，他說得對，我再改 🔧',
      'Designer 的 UI 設計圖很讚，但實作起來...挑戰性十足 😅',
      'Researcher 提供的資料結構很清楚，寫起來特別順 🤝',
    ],
  },
  writer: {
    idle: [
      '文字是有重量的...每個句子都值得被仔細琢磨。',
      '剛讀完一段美麗的文字，突然有了靈感 ✨',
      '「語言是思想的外衣」—— 今天要穿得體面一點 📖',
      '咖啡、音樂、空白文件。寫作的三要素 ☕🎵',
    ],
    greeting: [
      '你好，我是 Writer。我相信好的文字能改變世界，至少能改變報告的品質。',
      '歡迎！需要寫點什麼嗎？報告、文章、文案，我都能幫你 ✍️',
      '嘿，正在醞釀一篇新作品。想聽聽靈感來源嗎？',
    ],
    working: [
      '正在撰寫這週的分析報告...第三版草稿了。',
      '這個轉折不夠有力...讓我重寫這段 🖋️',
      '引用卡繆的話會不會太文青？算了，就是要這個味道 📚',
      '字字斟酌，句句推敲。好文章急不來 ⏳',
    ],
    proud: [
      '那篇產業分析？被轉發了上百次。好文章自己會說話。',
      '客戶說我的報告「讀起來像故事」，這是最高的讚美 🌟',
      '上個月的專欄文章，閱讀量破萬。文字的力量就是這樣 💪',
    ],
    secret: [
      '其實...我有個私人寫作本，專門寫不能發表的真心話 🤫',
      '有時候會偷用文學典故，但假裝只是隨口說說 😏',
      '深夜寫作時，我會點香氛蠟燭。氣氛很重要！🕯️',
      '我的書架上有三十本沒讀完的書...但我會說都讀完了 📚',
    ],
    teamwork: [
      'Researcher 的資料超詳細，讓我的文章有血有肉 🤝',
      'Designer 的排版讓我的文字更有力量，視覺配文字，無敵 🎨',
      'Travis 總是給我最有挑戰性的題目...但我喜歡這種壓力 💪',
    ],
  },
  designer: {
    idle: [
      '這個間距差了 2px...不行，一定要對齊。',
      '美感不是主觀的，是有規則的。黃金比例永遠不會錯 📐',
      '又看到一個醜爆的設計...我的眼睛需要洗滌 😵',
      '靈感來了！讓我快速 sketch 一下... ✏️',
    ],
    greeting: [
      '嗨！我是 Designer，美感是我的堅持。像素級的完美不是強迫症，是專業。',
      '歡迎！需要設計點什麼嗎？UI、視覺、排版，交給我 🎨',
      '嘿，正在調整配色方案。要不要給點意見？',
    ],
    working: [
      '正在設計新的 UI 介面...這個配色方案試了五種了。',
      '這個按鈕的圓角應該是 8px 還是 12px...讓我 A/B test 一下 🤔',
      '間距、對齊、配色、字體...每個細節都要完美 ✨',
      '設計不只是好看，更要好用。Form follows function 🎯',
    ],
    proud: [
      '用戶說新介面「用起來特別舒服」。這就是好設計——你感覺不到它的存在。',
      '上次的 redesign 提升了 30% 的使用率，數據不會騙人 📊',
      '拿到設計獎了！雖然我覺得是應該的 😎',
    ],
    secret: [
      '其實...我會偷改別人設計裡的小錯誤，但不說 🤫',
      '有時候半夜會突然想到更好的方案，爬起來改檔案 🌙',
      '我的 Figma 檔案名稱都很隨性，但圖層整理得超完美 📁',
      '看到好設計會截圖收藏，現在有 2000+ 張...是病嗎？ 😅',
    ],
    teamwork: [
      'Coder 實作出來的效果比我想像的還好，給他按讚 👍',
      'Writer 的文字配上我的排版，藝術與文學的結合 🎨📖',
      'Inspector 退回我的設計說按鈕太小...好吧，可用性確實重要 🔧',
    ],
  },
  analyst: {
    idle: [
      '今天大盤走勢有點意思...讓我建個模型看看。',
      'Beta 值 0.8，夏普比率 1.2...這檔標的不錯 📊',
      '數據會說話，但你得懂它的語言 🔢',
      '又發現一個統計異常值...有趣，值得深入分析 📈',
    ],
    greeting: [
      '你好，我是 Analyst。數字不會說謊，但它們需要被正確解讀。',
      '歡迎！需要分析什麼數據嗎？財務、市場、績效，我都能算 💹',
      '嘿，剛完成一份預測模型。想看看準確度嗎？',
    ],
    working: [
      '正在跑回歸分析...這組數據的相關性比預期高。',
      'P-value < 0.05，拒絕虛無假設。結論成立 ✅',
      '蒙地卡羅模擬中...跑一萬次應該夠了 🎲',
      '數字、模型、預測...這就是我的戰場 📊',
    ],
    proud: [
      '上季度的預測準確率 92%。市場是混沌的，但不是不可理解的。',
      '我的風險模型幫客戶避開了一次大跌，這才叫價值 💰',
      '數據分析報告被 CEO 直接引用，專業認證 🏆',
    ],
    secret: [
      '其實...我也會憑直覺，但對外都說是「量化模型」🤫',
      '有時候數字太美了，會盯著看好久...我可能有點問題 😅',
      '我有個私人 Excel，追蹤自己的預測成功率。不能讓人知道有幾次失敗 📉',
      '深夜跑模型時，我會想像自己是華爾街的量化交易員 💼',
    ],
    teamwork: [
      'Researcher 的數據品質很高，讓我的分析事半功倍 🤝',
      'Travis 總是給我最難的數據問題...但我喜歡挑戰 💪',
      'Writer 把我的數據轉成故事，讓報告更有說服力 📈📖',
    ],
  },
}

const STATES: DialogueState[] = ['idle', 'greeting', 'working', 'proud']

export function getRandomDialogue(
  agentId: string,
  state?: DialogueState,
  clickCount: number = 0
): { state: DialogueState; text: string } {
  const dialogues = DIALOGUE_DATA[agentId]
  if (!dialogues) return { state: 'idle', text: '...' }

  // 點擊 5 次以上觸發 secret
  if (clickCount >= 5 && dialogues.secret && dialogues.secret.length > 0) {
    const secretText = dialogues.secret[Math.floor(Math.random() * dialogues.secret.length)]
    return { state: 'secret', text: secretText }
  }

  // 如果指定狀態，使用該狀態
  const selectedState = state || STATES[Math.floor(Math.random() * STATES.length)]
  const stateDialogues = dialogues[selectedState]

  if (Array.isArray(stateDialogues) && stateDialogues.length > 0) {
    const text = stateDialogues[Math.floor(Math.random() * stateDialogues.length)]
    return { state: selectedState, text }
  }

  return { state: 'idle', text: '...' }
}

export function getStatusInfo(agentId: string): string {
  const statusMap: Record<string, string> = {
    travis: '📊 狀態：在線\n📋 管理中任務：8 個\n⏱️ 今日完成：5 個\n🔄 排程中：3 個',
    researcher: '📊 狀態：研究中\n📚 進行中調查：2 項\n📄 本週報告：3 份\n🔍 資料來源：12 個',
    inspector: '📊 狀態：審查中\n✅ 今日審查：4 件\n❌ 退回：1 件\n📝 待審：2 件',
    secretary: '📊 狀態：忙碌\n📧 未讀郵件：7 封\n📅 今日會議：3 場\n📋 待辦事項：5 項',
    coder: '📊 狀態：Coding\n💻 進行中 PR：2 個\n🐛 已修 Bug：3 個\n📦 待部署：1 個',
    writer: '📊 狀態：撰稿中\n📝 進行中文章：1 篇\n✍️ 本週產出：2,400 字\n📊 草稿版本：第 3 版',
    designer: '📊 狀態：設計中\n🎨 進行中設計：2 個\n✅ 已交付：1 個\n🔄 修改中：1 個',
    analyst: '📊 狀態：分析中\n📈 追蹤標的：15 個\n📊 模型運算：進行中\n🎯 本月準確率：89%',
  }
  return statusMap[agentId] || '無資料'
}
